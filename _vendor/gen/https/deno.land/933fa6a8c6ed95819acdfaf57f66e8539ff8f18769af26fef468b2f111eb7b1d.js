import { GenericPrompt } from "./_generic_prompt.ts";
import { brightBlue, dim, stripColor, underline } from "./deps.ts";
/** Generic input prompt representation. */ export class GenericInput extends GenericPrompt {
  inputValue = "";
  inputIndex = 0;
  /**
   * Prompt constructor.
   * @param settings Prompt settings.
   */ constructor(settings){
    super({
      ...settings,
      keys: {
        moveCursorLeft: [
          "left"
        ],
        moveCursorRight: [
          "right"
        ],
        deleteCharLeft: [
          "backspace"
        ],
        deleteCharRight: [
          "delete"
        ],
        ...settings.keys ?? {}
      }
    });
  }
  getCurrentInputValue() {
    return this.inputValue;
  }
  message() {
    const message = super.message() + " " + this.settings.pointer + " ";
    this.cursor.x = stripColor(message).length + this.inputIndex + 1;
    return message + this.input();
  }
  input() {
    return underline(this.inputValue);
  }
  highlight(value, color1 = dim, color2 = brightBlue) {
    value = value.toString();
    const inputLowerCase = this.getCurrentInputValue().toLowerCase();
    const valueLowerCase = value.toLowerCase();
    const index = valueLowerCase.indexOf(inputLowerCase);
    const matched = value.slice(index, index + inputLowerCase.length);
    return index >= 0 ? color1(value.slice(0, index)) + color2(matched) + color1(value.slice(index + inputLowerCase.length)) : value;
  }
  /**
   * Handle user input event.
   * @param event Key event.
   */ async handleEvent(event) {
    switch(true){
      case this.isKey(this.settings.keys, "moveCursorLeft", event):
        this.moveCursorLeft();
        break;
      case this.isKey(this.settings.keys, "moveCursorRight", event):
        this.moveCursorRight();
        break;
      case this.isKey(this.settings.keys, "deleteCharRight", event):
        this.deleteCharRight();
        break;
      case this.isKey(this.settings.keys, "deleteCharLeft", event):
        this.deleteChar();
        break;
      case event.char && !event.meta && !event.ctrl:
        this.addChar(event.char);
        break;
      default:
        await super.handleEvent(event);
    }
  }
  /** Add character to current input. */ addChar(char) {
    this.inputValue = this.inputValue.slice(0, this.inputIndex) + char + this.inputValue.slice(this.inputIndex);
    this.inputIndex++;
  }
  /** Move prompt cursor left. */ moveCursorLeft() {
    if (this.inputIndex > 0) {
      this.inputIndex--;
    }
  }
  /** Move prompt cursor right. */ moveCursorRight() {
    if (this.inputIndex < this.inputValue.length) {
      this.inputIndex++;
    }
  }
  /** Delete char left. */ deleteChar() {
    if (this.inputIndex > 0) {
      this.inputIndex--;
      this.deleteCharRight();
    }
  }
  /** Delete char right. */ deleteCharRight() {
    if (this.inputIndex < this.inputValue.length) {
      this.inputValue = this.inputValue.slice(0, this.inputIndex) + this.inputValue.slice(this.inputIndex + 1);
    }
  }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvY2xpZmZ5QHYwLjI1LjcvcHJvbXB0L19nZW5lcmljX2lucHV0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgS2V5Q29kZSB9IGZyb20gXCIuLi9rZXljb2RlL2tleV9jb2RlLnRzXCI7XG5pbXBvcnQge1xuICBHZW5lcmljUHJvbXB0LFxuICBHZW5lcmljUHJvbXB0S2V5cyxcbiAgR2VuZXJpY1Byb21wdE9wdGlvbnMsXG4gIEdlbmVyaWNQcm9tcHRTZXR0aW5ncyxcbn0gZnJvbSBcIi4vX2dlbmVyaWNfcHJvbXB0LnRzXCI7XG5pbXBvcnQgeyBicmlnaHRCbHVlLCBkaW0sIHN0cmlwQ29sb3IsIHVuZGVybGluZSB9IGZyb20gXCIuL2RlcHMudHNcIjtcblxuLyoqIElucHV0IGtleXMgb3B0aW9ucy4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJpY0lucHV0S2V5cyBleHRlbmRzIEdlbmVyaWNQcm9tcHRLZXlzIHtcbiAgbW92ZUN1cnNvckxlZnQ/OiBzdHJpbmdbXTtcbiAgbW92ZUN1cnNvclJpZ2h0Pzogc3RyaW5nW107XG4gIGRlbGV0ZUNoYXJMZWZ0Pzogc3RyaW5nW107XG4gIGRlbGV0ZUNoYXJSaWdodD86IHN0cmluZ1tdO1xufVxuXG4vKiogR2VuZXJpYyBpbnB1dCBwcm9tcHQgb3B0aW9ucy4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJpY0lucHV0UHJvbXB0T3B0aW9uczxUVmFsdWUsIFRSYXdWYWx1ZT5cbiAgZXh0ZW5kcyBHZW5lcmljUHJvbXB0T3B0aW9uczxUVmFsdWUsIFRSYXdWYWx1ZT4ge1xuICBrZXlzPzogR2VuZXJpY0lucHV0S2V5cztcbn1cblxuLyoqIEdlbmVyaWMgaW5wdXQgcHJvbXB0IHNldHRpbmdzLiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZW5lcmljSW5wdXRQcm9tcHRTZXR0aW5nczxUVmFsdWUsIFRSYXdWYWx1ZT5cbiAgZXh0ZW5kcyBHZW5lcmljUHJvbXB0U2V0dGluZ3M8VFZhbHVlLCBUUmF3VmFsdWU+IHtcbiAga2V5cz86IEdlbmVyaWNJbnB1dEtleXM7XG59XG5cbi8qKiBHZW5lcmljIGlucHV0IHByb21wdCByZXByZXNlbnRhdGlvbi4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBHZW5lcmljSW5wdXQ8XG4gIFRWYWx1ZSxcbiAgVFJhd1ZhbHVlLFxuICBUU2V0dGluZ3MgZXh0ZW5kcyBHZW5lcmljSW5wdXRQcm9tcHRTZXR0aW5nczxUVmFsdWUsIFRSYXdWYWx1ZT4sXG4+IGV4dGVuZHMgR2VuZXJpY1Byb21wdDxUVmFsdWUsIFRSYXdWYWx1ZSwgVFNldHRpbmdzPiB7XG4gIHByb3RlY3RlZCBpbnB1dFZhbHVlID0gXCJcIjtcbiAgcHJvdGVjdGVkIGlucHV0SW5kZXggPSAwO1xuXG4gIC8qKlxuICAgKiBQcm9tcHQgY29uc3RydWN0b3IuXG4gICAqIEBwYXJhbSBzZXR0aW5ncyBQcm9tcHQgc2V0dGluZ3MuXG4gICAqL1xuICBwcm90ZWN0ZWQgY29uc3RydWN0b3Ioc2V0dGluZ3M6IFRTZXR0aW5ncykge1xuICAgIHN1cGVyKHtcbiAgICAgIC4uLnNldHRpbmdzLFxuICAgICAga2V5czoge1xuICAgICAgICBtb3ZlQ3Vyc29yTGVmdDogW1wibGVmdFwiXSxcbiAgICAgICAgbW92ZUN1cnNvclJpZ2h0OiBbXCJyaWdodFwiXSxcbiAgICAgICAgZGVsZXRlQ2hhckxlZnQ6IFtcImJhY2tzcGFjZVwiXSxcbiAgICAgICAgZGVsZXRlQ2hhclJpZ2h0OiBbXCJkZWxldGVcIl0sXG4gICAgICAgIC4uLihzZXR0aW5ncy5rZXlzID8/IHt9KSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0Q3VycmVudElucHV0VmFsdWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5pbnB1dFZhbHVlO1xuICB9XG5cbiAgcHJvdGVjdGVkIG1lc3NhZ2UoKTogc3RyaW5nIHtcbiAgICBjb25zdCBtZXNzYWdlOiBzdHJpbmcgPSBzdXBlci5tZXNzYWdlKCkgKyBcIiBcIiArIHRoaXMuc2V0dGluZ3MucG9pbnRlciArIFwiIFwiO1xuICAgIHRoaXMuY3Vyc29yLnggPSBzdHJpcENvbG9yKG1lc3NhZ2UpLmxlbmd0aCArIHRoaXMuaW5wdXRJbmRleCArIDE7XG4gICAgcmV0dXJuIG1lc3NhZ2UgKyB0aGlzLmlucHV0KCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgaW5wdXQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdW5kZXJsaW5lKHRoaXMuaW5wdXRWYWx1ZSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgaGlnaGxpZ2h0KFxuICAgIHZhbHVlOiBzdHJpbmcgfCBudW1iZXIsXG4gICAgY29sb3IxOiAodmFsOiBzdHJpbmcpID0+IHN0cmluZyA9IGRpbSxcbiAgICBjb2xvcjI6ICh2YWw6IHN0cmluZykgPT4gc3RyaW5nID0gYnJpZ2h0Qmx1ZSxcbiAgKTogc3RyaW5nIHtcbiAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgY29uc3QgaW5wdXRMb3dlckNhc2UgPSB0aGlzLmdldEN1cnJlbnRJbnB1dFZhbHVlKCkudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCB2YWx1ZUxvd2VyQ2FzZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgaW5kZXggPSB2YWx1ZUxvd2VyQ2FzZS5pbmRleE9mKGlucHV0TG93ZXJDYXNlKTtcbiAgICBjb25zdCBtYXRjaGVkOiBzdHJpbmcgPSB2YWx1ZS5zbGljZShpbmRleCwgaW5kZXggKyBpbnB1dExvd2VyQ2FzZS5sZW5ndGgpO1xuICAgIHJldHVybiBpbmRleCA+PSAwXG4gICAgICA/IGNvbG9yMSh2YWx1ZS5zbGljZSgwLCBpbmRleCkpICsgY29sb3IyKG1hdGNoZWQpICtcbiAgICAgICAgY29sb3IxKHZhbHVlLnNsaWNlKGluZGV4ICsgaW5wdXRMb3dlckNhc2UubGVuZ3RoKSlcbiAgICAgIDogdmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIHVzZXIgaW5wdXQgZXZlbnQuXG4gICAqIEBwYXJhbSBldmVudCBLZXkgZXZlbnQuXG4gICAqL1xuICBwcm90ZWN0ZWQgYXN5bmMgaGFuZGxlRXZlbnQoZXZlbnQ6IEtleUNvZGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgIGNhc2UgdGhpcy5pc0tleSh0aGlzLnNldHRpbmdzLmtleXMsIFwibW92ZUN1cnNvckxlZnRcIiwgZXZlbnQpOlxuICAgICAgICB0aGlzLm1vdmVDdXJzb3JMZWZ0KCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSB0aGlzLmlzS2V5KHRoaXMuc2V0dGluZ3Mua2V5cywgXCJtb3ZlQ3Vyc29yUmlnaHRcIiwgZXZlbnQpOlxuICAgICAgICB0aGlzLm1vdmVDdXJzb3JSaWdodCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgdGhpcy5pc0tleSh0aGlzLnNldHRpbmdzLmtleXMsIFwiZGVsZXRlQ2hhclJpZ2h0XCIsIGV2ZW50KTpcbiAgICAgICAgdGhpcy5kZWxldGVDaGFyUmlnaHQoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIHRoaXMuaXNLZXkodGhpcy5zZXR0aW5ncy5rZXlzLCBcImRlbGV0ZUNoYXJMZWZ0XCIsIGV2ZW50KTpcbiAgICAgICAgdGhpcy5kZWxldGVDaGFyKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBldmVudC5jaGFyICYmICFldmVudC5tZXRhICYmICFldmVudC5jdHJsOlxuICAgICAgICB0aGlzLmFkZENoYXIoZXZlbnQuY2hhciEpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGF3YWl0IHN1cGVyLmhhbmRsZUV2ZW50KGV2ZW50KTtcbiAgICB9XG4gIH1cblxuICAvKiogQWRkIGNoYXJhY3RlciB0byBjdXJyZW50IGlucHV0LiAqL1xuICBwcm90ZWN0ZWQgYWRkQ2hhcihjaGFyOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLmlucHV0VmFsdWUgPSB0aGlzLmlucHV0VmFsdWUuc2xpY2UoMCwgdGhpcy5pbnB1dEluZGV4KSArIGNoYXIgK1xuICAgICAgdGhpcy5pbnB1dFZhbHVlLnNsaWNlKHRoaXMuaW5wdXRJbmRleCk7XG4gICAgdGhpcy5pbnB1dEluZGV4Kys7XG4gIH1cblxuICAvKiogTW92ZSBwcm9tcHQgY3Vyc29yIGxlZnQuICovXG4gIHByb3RlY3RlZCBtb3ZlQ3Vyc29yTGVmdCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5pbnB1dEluZGV4ID4gMCkge1xuICAgICAgdGhpcy5pbnB1dEluZGV4LS07XG4gICAgfVxuICB9XG5cbiAgLyoqIE1vdmUgcHJvbXB0IGN1cnNvciByaWdodC4gKi9cbiAgcHJvdGVjdGVkIG1vdmVDdXJzb3JSaWdodCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5pbnB1dEluZGV4IDwgdGhpcy5pbnB1dFZhbHVlLmxlbmd0aCkge1xuICAgICAgdGhpcy5pbnB1dEluZGV4Kys7XG4gICAgfVxuICB9XG5cbiAgLyoqIERlbGV0ZSBjaGFyIGxlZnQuICovXG4gIHByb3RlY3RlZCBkZWxldGVDaGFyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlucHV0SW5kZXggPiAwKSB7XG4gICAgICB0aGlzLmlucHV0SW5kZXgtLTtcbiAgICAgIHRoaXMuZGVsZXRlQ2hhclJpZ2h0KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIERlbGV0ZSBjaGFyIHJpZ2h0LiAqL1xuICBwcm90ZWN0ZWQgZGVsZXRlQ2hhclJpZ2h0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlucHV0SW5kZXggPCB0aGlzLmlucHV0VmFsdWUubGVuZ3RoKSB7XG4gICAgICB0aGlzLmlucHV0VmFsdWUgPSB0aGlzLmlucHV0VmFsdWUuc2xpY2UoMCwgdGhpcy5pbnB1dEluZGV4KSArXG4gICAgICAgIHRoaXMuaW5wdXRWYWx1ZS5zbGljZSh0aGlzLmlucHV0SW5kZXggKyAxKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxTQUNFLGFBQWEsUUFJUix1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