import { Command, CompletionsCommand } from "./deps/cliffy.ts";
import { getCurrentVersion } from "./core/utils/lume_version.ts";
const upgrade = new Command().description("Upgrade your Lume executable to the latest version.").option("--version <version:string>", "The version to upgrade to.").option("-d, --dev", "Install the latest development version (last Git commit).").example("lume upgrade -g", "Upgrades to the latest stable version.").example("lume upgrade --dev", "Upgrades to the latest development version.").action(async ({ dev, version })=>{
  const { upgrade } = await import("./cli/upgrade.ts");
  await upgrade(dev, version);
});
const create = new Command().description("Run an archetype to create more files.").example("lume new post 'Post title'", "Create a new post file using the _archetypes/post.ts archetype.")// @ts-ignore: todo: fix this
.action(async ({ config }, name, ...args)=>{
  const { create } = await import("./cli/create.ts");
  await create(config, name, args);
});
const run = new Command().description("Run one or more scripts from the config file.").example("lume run deploy", "Runs the `deploy` script.").example("lume run deploy --config=_config.ts", "Runs the `deploy` script from the _config.ts file.").example("lume run build deploy", "Runs the `build` and `deploy` scripts.").option("--config <config:string>", "The config file path.").option("--src <src:string>", "The source directory for your site.", {
  default: "./"
}).option("--dest <dest:string>", "The build destination.", {
  default: "_site"
}).option("--location <location>", "The URL location of the site.", {
  default: "http://localhost"
}).action(async ({ config }, ...scripts)=>{
  const { run } = await import("./cli/run.ts");
  await run(config, scripts);
});
const cms = new Command().description("Run Lume CMS.").option("--config <config:string>", "The config file path.").option("--src <src:string>", "The source directory for your site.", {
  default: "./"
}).option("--dest <dest:string>", "The build destination.", {
  default: "_site"
}).option("--location <location>", "The URL location of the site.", {
  default: "http://localhost"
}).action(async ({ config })=>{
  const { runCms } = await import("./cli/cms.ts");
  await runCms(config);
});
const lume = new Command().name("ðŸ”¥lume").version(()=>getCurrentVersion()).description("A static site generator for Deno. \nDocs: https://lume.land").example("lume", "Builds the site.").example("lume --serve", "Serves the site in localhost.").example("lume upgrade", "Upgrades Lume to the latest version.").example("lume run <script>", "Runs a custom script.").example("lume [COMMAND] --help", "Shows the help for a command.").option("--config <config:string>", "The config file path.").option("--src <src:string>", "The source directory for your site.", {
  default: "./"
}).option("--dest <dest:string>", "The build destination.", {
  default: "_site"
}).option("--location <type:string>", "The URL location of the site.", {
  default: "http://localhost"
}).option("-s, --serve", "Start a live-reloading web server and watch changes.").option("-p, --port <port:number>", "The port where the server runs.", {
  default: 3000
}).option("-o, --open", "Open the site in a browser.", {
  depends: [
    "serve"
  ]
}).option("-w, --watch", "Build and watch changes.").action(async ({ config, serve, watch })=>{
  const { build } = await import("./cli/build.ts");
  await build(config, serve, watch);
}).command("new <archetype> [arguments...]", create).command("upgrade", upgrade).command("run <script...>", run).command("cms", cms).command("completions", new CompletionsCommand());
try {
  await lume.parse(Deno.args);
} catch (error) {
  console.error(Deno.inspect(error, {
    colors: true
  }));
  Deno.exit(1);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvbHVtZUB2Mi4yLjAvY2xpLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbW1hbmQsIENvbXBsZXRpb25zQ29tbWFuZCB9IGZyb20gXCIuL2RlcHMvY2xpZmZ5LnRzXCI7XG5pbXBvcnQgeyBnZXRDdXJyZW50VmVyc2lvbiB9IGZyb20gXCIuL2NvcmUvdXRpbHMvbHVtZV92ZXJzaW9uLnRzXCI7XG5cbmNvbnN0IHVwZ3JhZGUgPSBuZXcgQ29tbWFuZCgpXG4gIC5kZXNjcmlwdGlvbihcIlVwZ3JhZGUgeW91ciBMdW1lIGV4ZWN1dGFibGUgdG8gdGhlIGxhdGVzdCB2ZXJzaW9uLlwiKVxuICAub3B0aW9uKFxuICAgIFwiLS12ZXJzaW9uIDx2ZXJzaW9uOnN0cmluZz5cIixcbiAgICBcIlRoZSB2ZXJzaW9uIHRvIHVwZ3JhZGUgdG8uXCIsXG4gIClcbiAgLm9wdGlvbihcbiAgICBcIi1kLCAtLWRldlwiLFxuICAgIFwiSW5zdGFsbCB0aGUgbGF0ZXN0IGRldmVsb3BtZW50IHZlcnNpb24gKGxhc3QgR2l0IGNvbW1pdCkuXCIsXG4gIClcbiAgLmV4YW1wbGUoXCJsdW1lIHVwZ3JhZGUgLWdcIiwgXCJVcGdyYWRlcyB0byB0aGUgbGF0ZXN0IHN0YWJsZSB2ZXJzaW9uLlwiKVxuICAuZXhhbXBsZShcImx1bWUgdXBncmFkZSAtLWRldlwiLCBcIlVwZ3JhZGVzIHRvIHRoZSBsYXRlc3QgZGV2ZWxvcG1lbnQgdmVyc2lvbi5cIilcbiAgLmFjdGlvbihhc3luYyAoeyBkZXYsIHZlcnNpb24gfSkgPT4ge1xuICAgIGNvbnN0IHsgdXBncmFkZSB9ID0gYXdhaXQgaW1wb3J0KFwiLi9jbGkvdXBncmFkZS50c1wiKTtcbiAgICBhd2FpdCB1cGdyYWRlKGRldiwgdmVyc2lvbik7XG4gIH0pO1xuXG5jb25zdCBjcmVhdGUgPSBuZXcgQ29tbWFuZCgpXG4gIC5kZXNjcmlwdGlvbihcIlJ1biBhbiBhcmNoZXR5cGUgdG8gY3JlYXRlIG1vcmUgZmlsZXMuXCIpXG4gIC5leGFtcGxlKFxuICAgIFwibHVtZSBuZXcgcG9zdCAnUG9zdCB0aXRsZSdcIixcbiAgICBcIkNyZWF0ZSBhIG5ldyBwb3N0IGZpbGUgdXNpbmcgdGhlIF9hcmNoZXR5cGVzL3Bvc3QudHMgYXJjaGV0eXBlLlwiLFxuICApXG4gIC8vIEB0cy1pZ25vcmU6IHRvZG86IGZpeCB0aGlzXG4gIC5hY3Rpb24oYXN5bmMgKHsgY29uZmlnIH0sIG5hbWUsIC4uLmFyZ3MpID0+IHtcbiAgICBjb25zdCB7IGNyZWF0ZSB9ID0gYXdhaXQgaW1wb3J0KFwiLi9jbGkvY3JlYXRlLnRzXCIpO1xuICAgIGF3YWl0IGNyZWF0ZShjb25maWcsIG5hbWUsIGFyZ3MpO1xuICB9KTtcblxuY29uc3QgcnVuID0gbmV3IENvbW1hbmQoKVxuICAuZGVzY3JpcHRpb24oXCJSdW4gb25lIG9yIG1vcmUgc2NyaXB0cyBmcm9tIHRoZSBjb25maWcgZmlsZS5cIilcbiAgLmV4YW1wbGUoXG4gICAgXCJsdW1lIHJ1biBkZXBsb3lcIixcbiAgICBcIlJ1bnMgdGhlIGBkZXBsb3lgIHNjcmlwdC5cIixcbiAgKVxuICAuZXhhbXBsZShcbiAgICBcImx1bWUgcnVuIGRlcGxveSAtLWNvbmZpZz1fY29uZmlnLnRzXCIsXG4gICAgXCJSdW5zIHRoZSBgZGVwbG95YCBzY3JpcHQgZnJvbSB0aGUgX2NvbmZpZy50cyBmaWxlLlwiLFxuICApXG4gIC5leGFtcGxlKFxuICAgIFwibHVtZSBydW4gYnVpbGQgZGVwbG95XCIsXG4gICAgXCJSdW5zIHRoZSBgYnVpbGRgIGFuZCBgZGVwbG95YCBzY3JpcHRzLlwiLFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLWNvbmZpZyA8Y29uZmlnOnN0cmluZz5cIixcbiAgICBcIlRoZSBjb25maWcgZmlsZSBwYXRoLlwiLFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLXNyYyA8c3JjOnN0cmluZz5cIixcbiAgICBcIlRoZSBzb3VyY2UgZGlyZWN0b3J5IGZvciB5b3VyIHNpdGUuXCIsXG4gICAgeyBkZWZhdWx0OiBcIi4vXCIgfSxcbiAgKVxuICAub3B0aW9uKFxuICAgIFwiLS1kZXN0IDxkZXN0OnN0cmluZz5cIixcbiAgICBcIlRoZSBidWlsZCBkZXN0aW5hdGlvbi5cIixcbiAgICB7IGRlZmF1bHQ6IFwiX3NpdGVcIiB9LFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLWxvY2F0aW9uIDxsb2NhdGlvbj5cIixcbiAgICBcIlRoZSBVUkwgbG9jYXRpb24gb2YgdGhlIHNpdGUuXCIsXG4gICAgeyBkZWZhdWx0OiBcImh0dHA6Ly9sb2NhbGhvc3RcIiB9LFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKHsgY29uZmlnIH0sIC4uLnNjcmlwdHMpID0+IHtcbiAgICBjb25zdCB7IHJ1biB9ID0gYXdhaXQgaW1wb3J0KFwiLi9jbGkvcnVuLnRzXCIpO1xuICAgIGF3YWl0IHJ1bihjb25maWcsIHNjcmlwdHMpO1xuICB9KTtcblxuY29uc3QgY21zID0gbmV3IENvbW1hbmQoKVxuICAuZGVzY3JpcHRpb24oXCJSdW4gTHVtZSBDTVMuXCIpXG4gIC5vcHRpb24oXG4gICAgXCItLWNvbmZpZyA8Y29uZmlnOnN0cmluZz5cIixcbiAgICBcIlRoZSBjb25maWcgZmlsZSBwYXRoLlwiLFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLXNyYyA8c3JjOnN0cmluZz5cIixcbiAgICBcIlRoZSBzb3VyY2UgZGlyZWN0b3J5IGZvciB5b3VyIHNpdGUuXCIsXG4gICAgeyBkZWZhdWx0OiBcIi4vXCIgfSxcbiAgKVxuICAub3B0aW9uKFxuICAgIFwiLS1kZXN0IDxkZXN0OnN0cmluZz5cIixcbiAgICBcIlRoZSBidWlsZCBkZXN0aW5hdGlvbi5cIixcbiAgICB7IGRlZmF1bHQ6IFwiX3NpdGVcIiB9LFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLWxvY2F0aW9uIDxsb2NhdGlvbj5cIixcbiAgICBcIlRoZSBVUkwgbG9jYXRpb24gb2YgdGhlIHNpdGUuXCIsXG4gICAgeyBkZWZhdWx0OiBcImh0dHA6Ly9sb2NhbGhvc3RcIiB9LFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKHsgY29uZmlnIH0pID0+IHtcbiAgICBjb25zdCB7IHJ1bkNtcyB9ID0gYXdhaXQgaW1wb3J0KFwiLi9jbGkvY21zLnRzXCIpO1xuICAgIGF3YWl0IHJ1bkNtcyhjb25maWcpO1xuICB9KTtcblxuY29uc3QgbHVtZSA9IG5ldyBDb21tYW5kKClcbiAgLm5hbWUoXCLwn5SlbHVtZVwiKVxuICAudmVyc2lvbigoKSA9PiBnZXRDdXJyZW50VmVyc2lvbigpKVxuICAuZGVzY3JpcHRpb24oXG4gICAgXCJBIHN0YXRpYyBzaXRlIGdlbmVyYXRvciBmb3IgRGVuby4gXFxuRG9jczogaHR0cHM6Ly9sdW1lLmxhbmRcIixcbiAgKVxuICAuZXhhbXBsZShcImx1bWVcIiwgXCJCdWlsZHMgdGhlIHNpdGUuXCIpXG4gIC5leGFtcGxlKFwibHVtZSAtLXNlcnZlXCIsIFwiU2VydmVzIHRoZSBzaXRlIGluIGxvY2FsaG9zdC5cIilcbiAgLmV4YW1wbGUoXCJsdW1lIHVwZ3JhZGVcIiwgXCJVcGdyYWRlcyBMdW1lIHRvIHRoZSBsYXRlc3QgdmVyc2lvbi5cIilcbiAgLmV4YW1wbGUoXCJsdW1lIHJ1biA8c2NyaXB0PlwiLCBcIlJ1bnMgYSBjdXN0b20gc2NyaXB0LlwiKVxuICAuZXhhbXBsZShcImx1bWUgW0NPTU1BTkRdIC0taGVscFwiLCBcIlNob3dzIHRoZSBoZWxwIGZvciBhIGNvbW1hbmQuXCIpXG4gIC5vcHRpb24oXG4gICAgXCItLWNvbmZpZyA8Y29uZmlnOnN0cmluZz5cIixcbiAgICBcIlRoZSBjb25maWcgZmlsZSBwYXRoLlwiLFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLXNyYyA8c3JjOnN0cmluZz5cIixcbiAgICBcIlRoZSBzb3VyY2UgZGlyZWN0b3J5IGZvciB5b3VyIHNpdGUuXCIsXG4gICAgeyBkZWZhdWx0OiBcIi4vXCIgfSxcbiAgKVxuICAub3B0aW9uKFxuICAgIFwiLS1kZXN0IDxkZXN0OnN0cmluZz5cIixcbiAgICBcIlRoZSBidWlsZCBkZXN0aW5hdGlvbi5cIixcbiAgICB7IGRlZmF1bHQ6IFwiX3NpdGVcIiB9LFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLWxvY2F0aW9uIDx0eXBlOnN0cmluZz5cIixcbiAgICBcIlRoZSBVUkwgbG9jYXRpb24gb2YgdGhlIHNpdGUuXCIsXG4gICAgeyBkZWZhdWx0OiBcImh0dHA6Ly9sb2NhbGhvc3RcIiB9LFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItcywgLS1zZXJ2ZVwiLFxuICAgIFwiU3RhcnQgYSBsaXZlLXJlbG9hZGluZyB3ZWIgc2VydmVyIGFuZCB3YXRjaCBjaGFuZ2VzLlwiLFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItcCwgLS1wb3J0IDxwb3J0Om51bWJlcj5cIixcbiAgICBcIlRoZSBwb3J0IHdoZXJlIHRoZSBzZXJ2ZXIgcnVucy5cIixcbiAgICB7IGRlZmF1bHQ6IDMwMDAgfSxcbiAgKVxuICAub3B0aW9uKFxuICAgIFwiLW8sIC0tb3BlblwiLFxuICAgIFwiT3BlbiB0aGUgc2l0ZSBpbiBhIGJyb3dzZXIuXCIsXG4gICAgeyBkZXBlbmRzOiBbXCJzZXJ2ZVwiXSB9LFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItdywgLS13YXRjaFwiLFxuICAgIFwiQnVpbGQgYW5kIHdhdGNoIGNoYW5nZXMuXCIsXG4gIClcbiAgLmFjdGlvbihhc3luYyAoeyBjb25maWcsIHNlcnZlLCB3YXRjaCB9KSA9PiB7XG4gICAgY29uc3QgeyBidWlsZCB9ID0gYXdhaXQgaW1wb3J0KFwiLi9jbGkvYnVpbGQudHNcIik7XG4gICAgYXdhaXQgYnVpbGQoY29uZmlnLCBzZXJ2ZSwgd2F0Y2gpO1xuICB9KVxuICAuY29tbWFuZChcIm5ldyA8YXJjaGV0eXBlPiBbYXJndW1lbnRzLi4uXVwiLCBjcmVhdGUpXG4gIC5jb21tYW5kKFwidXBncmFkZVwiLCB1cGdyYWRlKVxuICAuY29tbWFuZChcInJ1biA8c2NyaXB0Li4uPlwiLCBydW4pXG4gIC5jb21tYW5kKFwiY21zXCIsIGNtcylcbiAgLmNvbW1hbmQoXCJjb21wbGV0aW9uc1wiLCBuZXcgQ29tcGxldGlvbnNDb21tYW5kKCkpO1xuXG50cnkge1xuICBhd2FpdCBsdW1lLnBhcnNlKERlbm8uYXJncyk7XG59IGNhdGNoIChlcnJvcikge1xuICBjb25zb2xlLmVycm9yKERlbm8uaW5zcGVjdChlcnJvciwgeyBjb2xvcnM6IHRydWUgfSkpO1xuICBEZW5vLmV4aXQoMSk7XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsU0FBUyxPQUFPLEVBQUUsa0JBQWtCLFFBQVEsbUJBQW1CO0FBQy9ELFNBQVMsaUJBQWlCLFFBQVEsK0JBQStCO0FBRWpFLE1BQU0sVUFBVSxJQUFJLFVBQ2pCLFdBQVcsQ0FBQyx1REFDWixNQUFNLENBQ0wsOEJBQ0EsOEJBRUQsTUFBTSxDQUNMLGFBQ0EsNkRBRUQsT0FBTyxDQUFDLG1CQUFtQiwwQ0FDM0IsT0FBTyxDQUFDLHNCQUFzQiwrQ0FDOUIsTUFBTSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFO0VBQzdCLE1BQU0sRUFBRSxPQUFPLEVBQUUsR0FBRyxNQUFNLE1BQU0sQ0FBQztFQUNqQyxNQUFNLFFBQVEsS0FBSztBQUNyQjtBQUVGLE1BQU0sU0FBUyxJQUFJLFVBQ2hCLFdBQVcsQ0FBQywwQ0FDWixPQUFPLENBQ04sOEJBQ0Esa0VBRUYsNkJBQTZCO0NBQzVCLE1BQU0sQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUUsTUFBTSxHQUFHO0VBQ2xDLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxNQUFNLE1BQU0sQ0FBQztFQUNoQyxNQUFNLE9BQU8sUUFBUSxNQUFNO0FBQzdCO0FBRUYsTUFBTSxNQUFNLElBQUksVUFDYixXQUFXLENBQUMsaURBQ1osT0FBTyxDQUNOLG1CQUNBLDZCQUVELE9BQU8sQ0FDTix1Q0FDQSxzREFFRCxPQUFPLENBQ04seUJBQ0EsMENBRUQsTUFBTSxDQUNMLDRCQUNBLHlCQUVELE1BQU0sQ0FDTCxzQkFDQSx1Q0FDQTtFQUFFLFNBQVM7QUFBSyxHQUVqQixNQUFNLENBQ0wsd0JBQ0EsMEJBQ0E7RUFBRSxTQUFTO0FBQVEsR0FFcEIsTUFBTSxDQUNMLHlCQUNBLGlDQUNBO0VBQUUsU0FBUztBQUFtQixHQUUvQixNQUFNLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFLEdBQUc7RUFDNUIsTUFBTSxFQUFFLEdBQUcsRUFBRSxHQUFHLE1BQU0sTUFBTSxDQUFDO0VBQzdCLE1BQU0sSUFBSSxRQUFRO0FBQ3BCO0FBRUYsTUFBTSxNQUFNLElBQUksVUFDYixXQUFXLENBQUMsaUJBQ1osTUFBTSxDQUNMLDRCQUNBLHlCQUVELE1BQU0sQ0FDTCxzQkFDQSx1Q0FDQTtFQUFFLFNBQVM7QUFBSyxHQUVqQixNQUFNLENBQ0wsd0JBQ0EsMEJBQ0E7RUFBRSxTQUFTO0FBQVEsR0FFcEIsTUFBTSxDQUNMLHlCQUNBLGlDQUNBO0VBQUUsU0FBUztBQUFtQixHQUUvQixNQUFNLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRTtFQUN2QixNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsTUFBTSxNQUFNLENBQUM7RUFDaEMsTUFBTSxPQUFPO0FBQ2Y7QUFFRixNQUFNLE9BQU8sSUFBSSxVQUNkLElBQUksQ0FBQyxVQUNMLE9BQU8sQ0FBQyxJQUFNLHFCQUNkLFdBQVcsQ0FDViwrREFFRCxPQUFPLENBQUMsUUFBUSxvQkFDaEIsT0FBTyxDQUFDLGdCQUFnQixpQ0FDeEIsT0FBTyxDQUFDLGdCQUFnQix3Q0FDeEIsT0FBTyxDQUFDLHFCQUFxQix5QkFDN0IsT0FBTyxDQUFDLHlCQUF5QixpQ0FDakMsTUFBTSxDQUNMLDRCQUNBLHlCQUVELE1BQU0sQ0FDTCxzQkFDQSx1Q0FDQTtFQUFFLFNBQVM7QUFBSyxHQUVqQixNQUFNLENBQ0wsd0JBQ0EsMEJBQ0E7RUFBRSxTQUFTO0FBQVEsR0FFcEIsTUFBTSxDQUNMLDRCQUNBLGlDQUNBO0VBQUUsU0FBUztBQUFtQixHQUUvQixNQUFNLENBQ0wsZUFDQSx3REFFRCxNQUFNLENBQ0wsNEJBQ0EsbUNBQ0E7RUFBRSxTQUFTO0FBQUssR0FFakIsTUFBTSxDQUNMLGNBQ0EsK0JBQ0E7RUFBRSxTQUFTO0lBQUM7R0FBUTtBQUFDLEdBRXRCLE1BQU0sQ0FDTCxlQUNBLDRCQUVELE1BQU0sQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUU7RUFDckMsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLE1BQU0sTUFBTSxDQUFDO0VBQy9CLE1BQU0sTUFBTSxRQUFRLE9BQU87QUFDN0IsR0FDQyxPQUFPLENBQUMsa0NBQWtDLFFBQzFDLE9BQU8sQ0FBQyxXQUFXLFNBQ25CLE9BQU8sQ0FBQyxtQkFBbUIsS0FDM0IsT0FBTyxDQUFDLE9BQU8sS0FDZixPQUFPLENBQUMsZUFBZSxJQUFJO0FBRTlCLElBQUk7RUFDRixNQUFNLEtBQUssS0FBSyxDQUFDLEtBQUssSUFBSTtBQUM1QixFQUFFLE9BQU8sT0FBTztFQUNkLFFBQVEsS0FBSyxDQUFDLEtBQUssT0FBTyxDQUFDLE9BQU87SUFBRSxRQUFRO0VBQUs7RUFDakQsS0FBSyxJQUFJLENBQUM7QUFDWiJ9